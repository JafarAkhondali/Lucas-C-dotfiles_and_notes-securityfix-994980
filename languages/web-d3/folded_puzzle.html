<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Folded puzzle</title>
    <style>
    body {
      margin: 4rem auto;
      line-height: 1.6;
      font-family: sans-serif;
      color: #444;
    }
    #download-section { padding-top: 1rem; }
    p { font-size: small; }
    svg {
      width: 100%;
      height: auto;
    }
    @media screen {
      body { max-width: 54rem; }
    }
    @media print {
      .no-print { display: none; }
    }
    </style>
  </head>
  <body>
    <blockquote>
     The problem is to fold the above triangles into a tetrahedron so that the head, body, and tail of the image match up, and so that the remaining face is blank.
    </blockquote>
    <div>Puzzle origin:
      <ul>
        <li><a href="http://www.geom.uiuc.edu/docs/forum/ElPuz/">the Elephant puzzle</a> and <a href="http://www.geom.uiuc.edu/docs/forum/ElPuz/SolElPz.html">its solution</a></li>
        <li><a href="https://erikdemaine.org/puzzles/CSAIL2006/">CSAIL 2006 Beaver puzzle</a></li>
      </ul>
    </div>
    <div class="no-print">
      <label for="folded-img">Select an image:</label>
      <input id="folded-img" type="file" />
      <div id="download-section" style="display: none">
        <a id="download-link">Click here to download SVG file</a>
        <p>(there are numerous websites that can then convert this SVG file to an easily printable PDF)</p>
      </div>
      <script>
      document.getElementById('folded-img').addEventListener('change', function() {
        const uploadedFile = this.files[0]
        const reader = new FileReader()
        reader.addEventListener('load', function() {
            const dataUrl = this.result
            console.log('dataUrl:', dataUrl);
            [].forEach.call(document.getElementsByTagName('image'), image => image.setAttributeNS('http://www.w3.org/1999/xlink', 'href', dataUrl))
            // Generating a downloable SVG file:
            const svgData = document.getElementsByTagName('svg')[0].outerHTML
            const svgBlob = new Blob([svgData], {type: 'image/svg+xml;charset=utf-8'})
            const downloadButton = document.getElementById('download-link')
            downloadButton.href = URL.createObjectURL(svgBlob)
            downloadButton.download = uploadedFile.name.split('.')[0] + '.svg'
            document.getElementById('download-section').style.display = 'block'
        });
        reader.readAsDataURL(uploadedFile)
      })
      </script>
    </div>
    <svg width="1400" height="1400" viewBox="-700 -700 1400 1400"
         xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <defs style="position: absolute; top: -9000px;">
        <pattern id="head-down" width="1" height="1">
          <image xlink:href="folded.png" x="160" y="-50" width="500" height="500"/>
        </pattern>
        <pattern id="body-up" width="1" height="1">
          <image xlink:href="folded.png" x="-40" y="-50" width="500" height="500"/>
        </pattern>
        <pattern id="tail-down" width="1" height="1">
          <image xlink:href="folded.png" x="-240" y="-50" width="500" height="500"/>
        </pattern>
        <pattern id="head-up-rot60" width="1" height="1">
          <polygon points="0,0 200,346.41 400,0"
                   fill="url(#head-down)" transform="rotate(60, 100, 173.21)"/>
        </pattern>
        <pattern id="head-rot180" width="1" height="1">
          <polygon points="0,0 200,346.41 400,0"
                   fill="url(#head-down)" transform="rotate(180, 200, 173.21)"/>
        </pattern>
        <pattern id="head-up-rot300" width="1" height="1">
          <polygon points="0,0 200,346.41 400,0"
                   fill="url(#head-down)" transform="rotate(-60, 100, 173.21)"/>
        </pattern>
        <pattern id="body-down-rot60" width="1" height="1">
          <polygon points="0,346.41 200,0 400,346.41"
                   fill="url(#body-up)" transform="rotate(60, 300, 173.21)"/>
        </pattern>
        <pattern id="body-up-rot120" width="1" height="1">
          <polygon points="400,346.41 200,0 0,346.41"
                   fill="url(#body-up)" transform="rotate(120, 200, 230.94)"/>
        </pattern>
        <pattern id="body-rot180" width="1" height="1">
          <polygon points="0,346.41 200,0 400,346.41"
                   fill="url(#body-up)" transform="rotate(180, 200, 173.21)"/>
        </pattern>
        <pattern id="body-down-rot300" width="1" height="1">
          <polygon points="0,346.41 200,0 400,346.41"
                   fill="url(#body-up)" transform="rotate(-60, 100, 173.21)"/>
        </pattern>
        <pattern id="tail-down-rot240" width="1" height="1">
          <polygon points="0,346.41 200,0 400,346.41"
                   fill="url(#tail-down)" transform="rotate(-60, 100, 173.21)"/>
        </pattern>
      </defs>

      <!-- Left for debugging if needed: -->
      <polygon points="-200,-346.41 -400,-692.82 0,-692.82"
               fill="url(#head-down)" style="stroke:black;stroke-width:1; display: none" />
      <polygon points="-200,-346.41 0,-692.82 200,-346.41"
               fill="url(#body-up)" style="stroke:black;stroke-width:1;   display: none" />
      <polygon points="200,-346.41 0,-692.82 400,-692.82"
               fill="url(#tail-down)" style="stroke:black;stroke-width:1; display: none" />

      <polygon points="-200,-346.41 0,-692.82 200,-346.41"
               fill="url(#head-up-rot300)" style="stroke:black;stroke-width:1" />

      <polygon points="-400,0 -600,-346.41 -200,-346.41"
               fill="url(#tail-down)" style="stroke:black;stroke-width:1"/>
      <polygon points="0,0 -400,0 -200,-346.41"
               fill="url(#body-up-rot120)" style="stroke:black;stroke-width:1" />
      <polygon points="0,0 -200,-346.41 200,-346.41"
               fill="url(#tail-down)" style="stroke:black;stroke-width:1"/>
      <polygon points="0,0 200,-346.41 400, 0"
               fill="url(#head-up-rot60)" style="stroke:black;stroke-width:1" />
      <polygon points="400,0 200,-346.41 600,-346.41"
               fill="url(#body-rot180)" style="stroke:black;stroke-width:1" />

      <polygon points="-200,346.41 -600,346.41 -400,0"
               fill="url(#head-rot180)" style="stroke:black;stroke-width:1"/>
      <polygon points="0,0 -200,346.41 -400,0"
               fill="url(#body-down-rot60)" style="stroke:black;stroke-width:1" />
      <polygon points="0,0 200,346.41 -200,346.41"
               fill="url(#body-up)" style="stroke:black;stroke-width:1" />
      <polygon points="0,0 400,0 200,346.41"
               fill="url(#body-down-rot300)" style="stroke:black;stroke-width:1" />
      <polygon points="400,0 200,346.41 600,346.41"
               fill="url(#head-up-rot300)" style="stroke:black;stroke-width:1" />

      <polygon points="0,692.82 200,346.41 -200,346.41"
               fill="url(#tail-down-rot240)" style="stroke:black;stroke-width:1" />

      <polygon points="0,0 400,0" style="stroke:black;stroke-width:5"/>
      <text x="430" y="0" dy=".3em" font-size="3em">&#9986;</text>
    </svg>
    <footer>
    <p>Created by Lucas Cimon : <a href="https://chezsoi.org/lucas/blog/">https://chezsoi.org/lucas/blog/</a></p>
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
    </footer>
  </body>
</html>