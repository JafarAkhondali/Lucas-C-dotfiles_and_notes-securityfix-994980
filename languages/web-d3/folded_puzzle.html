<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Folded puzzle</title>
    <style>
    body {
      margin: 4rem auto;
      line-height: 1.6;
      font-family: sans-serif;
      color: #444;
    }
    #download-section { padding-top: 1rem; }
    p { font-size: small; }
    svg {
      width: 100%;
      height: auto;
    }
    @media screen {
      body { max-width: 54rem; }
    }
    @media print {
      .no-print { display: none; }
    }
    </style>
  </head>
  <body>
    <blockquote>
      Fold this star-shaped puzzle into three triangles that make a complete beaver.
      You may only fold along the lines.
    </blockquote>
    <div>This is a customizable version of <a href="https://erikdemaine.org/puzzles/CSAIL2006/">Erik &amp; Martin Demaine's puzzle for CSAIL 2006</a>.</div>
    <svg width="1400" height="1400" viewBox="-700 -700 1400 1400"
         xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <defs style="position: absolute; top: -9000px;">
        <pattern id="head" width="1" height="1">
          <image xlink:href="folded.jpg" x="160" y="-50" width="500" height="500"/>
        </pattern>
        <pattern id="body" width="1" height="1">
          <image xlink:href="folded.jpg" x="-40" y="-50" width="500" height="500"/>
        </pattern>
        <pattern id="tail" width="1" height="1">
          <image xlink:href="folded.jpg" x="-240" y="-50" width="500" height="500"/>
        </pattern>
        <pattern id="head-rot60" width="1" height="1">
          <polygon points="0,0 200,346.41 400,0"
                   fill="url(#head)" transform="rotate(60, 100, 173.21)"/>
        </pattern>
        <pattern id="head-rot180" width="1" height="1">
          <polygon points="0,0 200,346.41 400,0"
                   fill="url(#head)" transform="rotate(180, 200, 173.21)"/>
        </pattern>
        <pattern id="head-rot300" width="1" height="1">
          <polygon points="0,0 200,346.41 400,0"
                   fill="url(#head)" transform="rotate(-60, 300, 173.21)"/>
        </pattern>
        <pattern id="body-rot60" width="1" height="1">
          <polygon points="0,346.41 200,0 400,346.41"
                   fill="url(#body)" transform="rotate(60, 300, 173.21)"/>
        </pattern>
        <pattern id="body-rot120" width="1" height="1">
          <polygon points="0,346.41 200,0 400,346.41"
                   fill="url(#body)" transform="rotate(120, 200, 230.94)"/>
        </pattern>
        <pattern id="body-rot180" width="1" height="1">
          <polygon points="0,346.41 200,0 400,346.41"
                   fill="url(#body)" transform="rotate(180, 200, 173.21)"/>
        </pattern>
        <pattern id="body-rot300" width="1" height="1">
          <polygon points="0,346.41 200,0 400,346.41"
                   fill="url(#body)" transform="rotate(-60, 100, 173.21)"/>
        </pattern>
        <pattern id="tail-rot120" width="1" height="1">
          <polygon points="0,0 200,346.41 400,0"
                   fill="url(#tail)" transform="rotate(-120, 200, 115.47)"/>
        </pattern>
      </defs>

      <!-- Left for debugging if needed: -->
      <polygon points="-200,-346.41 -400,-692.82 0,-692.82"
               fill="url(#head)" style="stroke:black;stroke-width:1; display: none" />
      <polygon points="-200,-346.41 0,-692.82 200,-346.41"
               fill="url(#body)" style="stroke:black;stroke-width:1; display: none" />
      <polygon points="200,-346.41 0,-692.82 400,-692.82"
               fill="url(#tail)" style="stroke:black;stroke-width:1; display: none" />

      <polygon points="-200,-346.41 0,-692.82 200,-346.41"
               fill="url(#head-rot300)" style="stroke:black;stroke-width:1" />

      <polygon points="-400,0 -600,-346.41 -200,-346.41" class="side"
               fill="url(#tail)" style="stroke:black;stroke-width:1"/>
      <polygon points="0,0 -400,0 -200,-346.41"
               fill="url(#body-rot120)" style="stroke:black;stroke-width:1" />
      <polygon points="0,0 -200,-346.41 200,-346.41"
               fill="url(#tail)" style="stroke:black;stroke-width:1"/>
      <polygon points="0,0 200,-346.41 400, 0"
               fill="url(#head-rot60)" style="stroke:black;stroke-width:1" />
      <polygon points="400,0 200,-346.41 600,-346.41" class="side"
               fill="url(#body-rot180)" style="stroke:black;stroke-width:1" />

      <polygon points="-200,346.41 -600,346.41 -400,0"
               fill="url(#head-rot180)" style="stroke:black;stroke-width:1"/>
      <polygon points="0,0 -200,346.41 -400,0"
               fill="url(#body-rot60)" style="stroke:black;stroke-width:1" />
      <polygon points="0,0 200,346.41 -200,346.41"
               fill="url(#body)" style="stroke:black;stroke-width:1" />
      <polygon points="0,0 400,0 200,346.41"
               fill="url(#body-rot300)" style="stroke:black;stroke-width:1" />
      <polygon points="400,0 200,346.41 600,346.41" class="side"
               fill="url(#head-rot300)" style="stroke:black;stroke-width:1" />

      <polygon points="0,692.82 200,346.41 -200,346.41"
               fill="url(#tail-rot120)" style="stroke:black;stroke-width:1" />

      <polygon points="0,0 400,0" style="stroke:black;stroke-width:5"/>
      <text x="430" y="0" dy=".3em" font-size="3em">&#9986;</text>

      <polygon points="-200,-346.41 0,0" class="first-fold"/>
      <polygon points="-200,346.41 200,346.41" class="first-fold"/>
      <polygon points="200,346.41 400,0" class="first-fold"/>
    </svg>
    <div><button id="hint-1">Hint 1</button><span id="hint-1-text" style="display: none">You must form a tetrahedron</span></div>
    <div><button id="hint-2">Hint 2</button><span id="hint-2-text" style="display: none">The final beaver faces are shown in red</span></div>
    <div><button id="hint-3">Hint 3</button><span id="hint-3-text" style="display: none">The three first folds are shown in blue</span></div>
    <p>Image source: <a href="https://www.publicdomainpictures.net/en/view-image.php?image=182570&picture=native-art-21">publicdomainpictures.net</a></p>
    <div class="no-print">
      <label for="folded-img">Select another image:</label>
      <input id="folded-img" type="file" />
      <div id="download-section" style="display: none">
        <a id="download-link">Click here to download SVG file</a>
        <p>(there are numerous websites that can then convert this SVG file to an easily printable PDF)</p>
      </div>
    </div>
    <footer>
    <p>Created by Lucas Cimon : <a href="https://chezsoi.org/lucas/blog/">https://chezsoi.org/lucas/blog/</a></p>
    </footer>
    <script>
    document.getElementById('folded-img').addEventListener('change', function() {
      const uploadedFile = this.files[0]
      const reader = new FileReader()
      reader.addEventListener('load', function() {
          const dataUrl = this.result
          console.log('dataUrl:', dataUrl);
          [].forEach.call(document.getElementsByTagName('image'), image => image.setAttributeNS('http://www.w3.org/1999/xlink', 'href', dataUrl))
          // Generating a downloable SVG file:
          const svgData = document.getElementsByTagName('svg')[0].outerHTML
          const svgBlob = new Blob([svgData], {type: 'image/svg+xml;charset=utf-8'})
          const downloadButton = document.getElementById('download-link')
          downloadButton.href = URL.createObjectURL(svgBlob)
          downloadButton.download = uploadedFile.name.split('.')[0] + '.svg'
          document.getElementById('download-section').style.display = 'block'
      });
      reader.readAsDataURL(uploadedFile)
    })
    document.getElementById('hint-1').onclick = () => {
      document.getElementById('hint-1-text').style.display = 'block'
    }
    document.getElementById('hint-2').onclick = () => {
      [].forEach.call(document.getElementsByClassName('side'), side => {
          side.style.stroke = 'red'
          side.style['stroke-width'] = 3
      })
      document.getElementById('hint-2-text').style.display = 'block'
    }
    document.getElementById('hint-3').onclick = () => {
      [].forEach.call(document.getElementsByClassName('first-fold'), side => {
          side.style.stroke = 'blue'
          side.style['stroke-width'] = 3
      })
      document.getElementById('hint-3-text').style.display = 'block'
    }
    </script>
  </body>
</html>